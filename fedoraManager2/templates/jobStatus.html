{% include 'header.html' %}
{% if status_package.jobInit is defined %}
	<p style="color:green; font-weight:bold;">Job #{{ status_package.job_num }} initiatied.</p>
{% endif %}
<p>Job Status for {{ status_package.job_num }}: <span id="job_status">{{ status_package.job_status }}</span><p>
<p><span id="completed_tasks">{{ taskHand.last_completed_task_num }}</span> / {{ taskHand.estimated_tasks }} tasks from job #{{ status_package.job_num }} completed.</p>
<button onclick="poll();">refresh</button>

<!-- script to long-poll update above, proof of concept -->
<script type="text/javascript">
	function poll(){
		setTimeout(function(){
			url = "http://162.243.93.130:5001/jobStatus/{{status_package.job_num}}?data=true";
			$.ajax({ 
				url: url, 
				dataType:"json",
				success: function(response){			
					console.log(response);	
					$("#completed_tasks").html(response.completed_tasks);
					$("#job_status").html(response.job_status);
					if (response.job_status != "complete"){
						poll();	
					}
					else{
						console.log("finis!");
					}					
				}		
			});
		}, 500)		
	}	
	// automatic start
	poll();
</script>
